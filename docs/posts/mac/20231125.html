<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"  xml:lang="zh-CN" lang="zh-CN" >
<head>
    <title>Mac 终端设置代理，设置一键开启和取消 &middot; 回忆中的明天</title>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="keywords" content="blog,shell,mac"/>
    <meta name="description" content="终端配置代理
这里以macOS为例，使用的是zsh，对应的用户配置文件就是~/.zshrc。"/>
    
    <link type="text/css" rel="stylesheet" href="https://ichochy.com/css/print.css" media="print">
    <link type="text/css" rel="stylesheet" href="https://ichochy.com/css/poole.css">
    <link type="text/css" rel="stylesheet" href="https://ichochy.com/css/syntax.css">
    <link type="text/css" rel="stylesheet" href="https://ichochy.com/css/hyde.css">
    
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://ichochy.com/apple-touch-icon-144-precomposed.png">
    <link rel="shortcut icon" href="https://ichochy.com/favicon.png">
    
</head>

  <body class="theme-base-08 layout-reverse">
  <aside class="sidebar">
  <div id = "title" class="container sidebar-sticky">
    <div class="sidebar-about">
      <a href="https://ichochy.com/"><p class="title">回忆中的明天</p></a>
      <p class="lead">码农小站，写点Java、Swift和感悟</p>
    </div>
      <p>
        <span id="doc_search"></span>
      </p>
    <nav>
      <ul class="sidebar-nav">
        <li><a href="https://ichochy.com/"> 首页 </a></li>
        <li><a href="https://ichochy.com/search.html"> 搜索 </a></li>
        <li><a href="https://ichochy.com/links.html"> 友链 </a></li>
        <li><a href="https://ichochy.com/about.html"> 简介 </a></li>
        <li><a href="https://ichochy.com/analytics.html"> 分析 </a></li>
        <li><a href="https://ichochy.com/sites.html"> 站点 </a></li>
        <li><a href="https://ichochy.com/vps.html"> VPS </a></li></ul>
    </nav>
    <div class = "other">
        <ol>
            <li>&copy; 2020 - 2025 iChochy.</li>
        </ol>
    </div>
  </div>
  
  <div id = "toc" class="container sidebar-toc">
  <nav id="TableOfContents">
  <ul>
    <li><a href="#终端配置代理">终端配置代理</a>
      <ul>
        <li><a href="#导入环境变量">导入环境变量</a></li>
        <li><a href="#加载配置文件">加载配置文件</a></li>
        <li><a href="#查看环境变量">查看环境变量</a></li>
        <li><a href="#测试">测试</a></li>
      </ul>
    </li>
    <li><a href="#通过命令添加删除代理">通过命令添加、删除代理</a></li>
    <li><a href="#通过-ip-来查看当前的外网-ip">通过 <code>ip</code> 来查看当前的外网 <code>IP</code></a>
      <ul>
        <li><a href="#查询ip信息的网站">查询IP信息的网站</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
  
</aside>
    <main class="content container">
    
<h1>Mac 终端设置代理，设置一键开启和取消</h1>
<hr>
<div class="post">
  

  
  <div class="related">
    <ul class="related-tags">
      <b>分类:</b>
      
      <li>
        <a href="https://ichochy.com/categories/mac.html">#Mac</a>
      </li>
      
    </ul>
  </div>
  


  <div class="related">
    <ul class="related-tags">
  
      <b>标签:</b>
      
      <li>
        <a href="https://ichochy.com/tags/blog.html">#blog</a>
      </li>
      
      <li>
        <a href="https://ichochy.com/tags/shell.html">#shell</a>
      </li>
      
      <li>
        <a href="https://ichochy.com/tags/mac.html">#mac</a>
      </li>
      
    
    </ul>
  </div>

   <div>
   <time class="post-date">
       <b>时间：</b><em>2023/11/25 11:35:45</em>
       <b>点击：</b><span id="view-count">-</span>次
    </time>
   </div>
<b>原文：</b><a href="https://ichochy.com/posts/mac/20231125.html">https://ichochy.com/posts/mac/20231125.html</a>
<hr>

  <h2 id="终端配置代理">终端配置代理</h2>
<p>这里以<code>macOS</code>为例，使用的是<code>zsh</code>，对应的用户配置文件就是<code>~/.zshrc</code>。</p>
<h3 id="导入环境变量">导入环境变量</h3>
<p>将下面信息写入到<code>~/.zshrc</code>文件中<br>
分别导入 <code>http_proxy、https_proxy、sockes_proxy</code> 三个环竟变量</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>export http_proxy<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;http://127.0.0.1/8888&#34;</span>
</span></span><span style="display:flex;"><span>export https_proxy<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;http://127.0.0.1/8888&#34;</span>
</span></span><span style="display:flex;"><span>export socks_proxy<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;socks://127.0.0.1/8885&#34;</span>
</span></span></code></pre></div><p><strong>注：根据自己的代理地址配置</strong></p>
<h3 id="加载配置文件">加载配置文件</h3>
<p>在终端中运行 <code>source ~/.zshrc</code>，加载配置文件，让其配置生效</p>
<pre tabindex="0"><code>引起注意，说三遍……
运行 `source` 加载配置文件  
运行 `source` 加载配置文件  
运行 `source` 加载配置文件  
……
</code></pre><h3 id="查看环境变量">查看环境变量</h3>
<p>在终端中运行 <code>env</code> ，查看导入的环境变量是否生效</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>TERM_PROGRAM<span style="color:#f92672">=</span>Apple_Terminal
</span></span><span style="display:flex;"><span>SHELL<span style="color:#f92672">=</span>/bin/zsh
</span></span><span style="display:flex;"><span>USER<span style="color:#f92672">=</span>iChochy
</span></span><span style="display:flex;"><span>HOME<span style="color:#f92672">=</span>/Users/iChochy
</span></span><span style="display:flex;"><span>http_proxy<span style="color:#f92672">=</span>http://127.0.0.1/8888
</span></span><span style="display:flex;"><span>https_proxy<span style="color:#f92672">=</span>http://127.0.0.1/8888
</span></span><span style="display:flex;"><span>socks_proxy<span style="color:#f92672">=</span>socks://127.0.0.1/8885
</span></span><span style="display:flex;"><span>……
</span></span></code></pre></div><p>可以看到 <code>http_proxy、https_proxy、sockes_proxy</code> 已经生效了。</p>
<h3 id="测试">测试</h3>
<p>通过 <code>curl</code> 来作测，查看网络访问的情况</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>curl -vI https://ichochy.com
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>* Uses proxy env variable HTTP_PROXY <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;http://127.0.0.1:8888&#39;</span>
</span></span><span style="display:flex;"><span>*   Trying 127.0.0.1:8888...
</span></span><span style="display:flex;"><span>* Connected to 127.0.0.1 <span style="color:#f92672">(</span>127.0.0.1<span style="color:#f92672">)</span> port <span style="color:#ae81ff">8888</span> <span style="color:#f92672">(</span><span style="color:#75715e">#0)</span>
</span></span><span style="display:flex;"><span>&gt; HEAD http://ichochy.com/ HTTP/1.1
</span></span><span style="display:flex;"><span>&gt; Host: ichochy.com
</span></span><span style="display:flex;"><span>&gt; User-Agent: curl/8.1.2
</span></span><span style="display:flex;"><span>&gt; Accept: */*
</span></span><span style="display:flex;"><span>&gt; Proxy-Connection: Keep-Alive
</span></span><span style="display:flex;"><span>……
</span></span></code></pre></div><p>可以看到 <code>Trying 127.0.0.1:8888...</code> 通过代理访问网络</p>
<p><strong>注：curl 参数 <code>v</code> 显示请求详情，<code>I</code> 只显示请求头信息</strong></p>
<h2 id="通过命令添加删除代理">通过命令添加、删除代理</h2>
<p>在 <code>~/.zshrc</code> 中设置别名命令</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e"># 通过 alias 定义别名命令</span>
</span></span><span style="display:flex;"><span>alias add_proxy<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;export ALL_PROXY=http://127.0.0.1:8888&#39;</span>
</span></span><span style="display:flex;"><span>alias un_proxy<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;unset ALL_PROXY&#39;</span>
</span></span></code></pre></div><p>运行 <code>source ~/.zshrc</code> 加载配置文件<br>
执行 <code>add_proxy</code> 命令添加代理<br>
执行 <code>un_proxy</code> 命令删除代理</p>
<pre tabindex="0"><code>引起注意，说三遍……
运行 `source` 加载配置文件  
运行 `source` 加载配置文件  
运行 `source` 加载配置文件  
……
</code></pre><p><strong>注：<code>ALL_PROXY</code> 所有网络代理</strong></p>
<h2 id="通过-ip-来查看当前的外网-ip">通过 <code>ip</code> 来查看当前的外网 <code>IP</code></h2>
<p>在 <code>~/.zshrc</code> 中通过 <code>alias</code> 定义命令 <code>ip</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e"># 通过 alias 定义命令 `ip`</span>
</span></span><span style="display:flex;"><span>alias ip<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;curl ipinfo.io&#34;</span>
</span></span></code></pre></div><p>运行 <code>source ~/.zshrc</code> 加载配置文件<br>
执行 <code>ip</code> 命令查询外网 <code>IP</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e"># ip</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;ip&#34;</span>: <span style="color:#e6db74">&#34;8.8.8.8&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;city&#34;</span>: <span style="color:#e6db74">&#34;sh&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;region&#34;</span>: <span style="color:#e6db74">&#34;sh&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;country&#34;</span>: <span style="color:#e6db74">&#34;CN&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;loc&#34;</span>: <span style="color:#e6db74">&#34;88,55&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;org&#34;</span>: <span style="color:#e6db74">&#34;CHINANET&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;timezone&#34;</span>: <span style="color:#e6db74">&#34;Asia/Shanghai&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;readme&#34;</span>: <span style="color:#e6db74">&#34;https://ipinfo.io/missingauth&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>% 
</span></span></code></pre></div><h3 id="查询ip信息的网站">查询IP信息的网站</h3>
<p><a href="https://bgp.he.net">https://bgp.he.net</a><br>
<a href="https://ipinfo.io">https://ipinfo.io</a><br>
<a href="https://ip-api.com">https://ip-api.com</a><br>
<a href="https://whoer.net">https://whoer.net</a></p>

  


<div class="related">
    <h2>相关文章</h2>
    <ul class="related-posts">
        
        <li>
            <h3>
                <a href="https://ichochy.com/posts/vps/20231120.html">
                    香港 CN2 优化线路带宽低延迟 VPS 服务器推荐
                </a>
                <small>
                    2023/11/20
                </small>
            </h3>
        </li>
        
        <li>
            <h3>
                <a href="https://ichochy.com/posts/vps/20231022.html">
                    菲律宾、马来西亚、泰国等多图 VPS 服务器便宜推荐
                </a>
                <small>
                    2023/10/22
                </small>
            </h3>
        </li>
        
        <li>
            <h3>
                <a href="https://ichochy.com/posts/shell/20221108.html">
                    12 个对新手最重要的 Linux 命令
                </a>
                <small>
                    2022/11/08
                </small>
            </h3>
        </li>
        
        <li>
            <h3>
                <a href="https://ichochy.com/posts/blog/20221107.html">
                    第一次通过 SSH key 免密连接 GitHub 的完整过程
                </a>
                <small>
                    2022/11/07
                </small>
            </h3>
        </li>
        
        <li>
            <h3>
                <a href="https://ichochy.com/posts/software/20211125.html">
                    RIME 鼠须管输入法使用，免费开源还可以自定义词库
                </a>
                <small>
                    2021/11/25
                </small>
            </h3>
        </li>
        
    </ul>
</div>



  
<div class="pagination">
  
  <span class="pagination-link newer">
    上一篇：<a href="https://ichochy.com/posts/mac/20231128.html" class="pag-link">Mac launchctl 自定义服务启动</a>
  </span>
  
    
  <span class="pagination-link older">
    下一篇：<a href="https://ichochy.com/posts/software/20231125.html" class="pag-link">Nginx 配置(Config)中遇到的错误(Error)</a>
  </span>
    
</div>


</div>


    </main>
  </body>
<script type="text/javascript" src="https://ichochy.com/js/ready.js" defer></script>
<link rel="preconnect" href="https://NKR7XWIWN9-dsn.algolia.net" crossorigin />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@docsearch/css@3"/>
<script src="https://cdn.jsdelivr.net/npm/@docsearch/js@3"></script>
<script src = "/js/searchTop.js"></script>

<script data-ad-client="ca-pub-3691661241035911" async
        src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-8J2LHY81SL"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() {
        window.dataLayer.push(arguments);
    }
    gtag('js', new Date());
    gtag('config', 'G-8J2LHY81SL');
</script></html>
