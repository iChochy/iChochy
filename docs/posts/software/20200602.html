<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"  xml:lang="zh-CN" lang="zh-CN" >
<head>
    <link href="https://gmpg.org/xfn/11" rel="profile">
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="generator" content="Hugo 0.128.0">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Office 批量激活的命令工具 ospp &middot; 回忆中的明天</title>
    <meta name="keywords" content="office,kms,key,slmgr,ospp,software"/>
    <meta name="description" content="Office 软件保护平台脚本使你能够配置 Office 产品（包括 Project 和 Visio）的批量许可版本。 ospp.vbs 脚本 opss.vbs 脚本位于 Program Files\Microsoft Office\Office16 或 Program Files (x86)\Microsoft Office\Office16 文件夹。 适用于： Office 2019 和 Office 2016（"/>
    
    <link type="text/css" rel="stylesheet" href="https://ichochy.com/css/print.css" media="print">
    <link type="text/css" rel="stylesheet" href="https://ichochy.com/css/poole.css">
    <link type="text/css" rel="stylesheet" href="https://ichochy.com/css/syntax.css">
    <link type="text/css" rel="stylesheet" href="https://ichochy.com/css/hyde.css">
    
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://ichochy.com/apple-touch-icon-144-precomposed.png">
    <link rel="shortcut icon" href="https://ichochy.com/favicon.png">
    </head>

  <body class="theme-base-08 layout-reverse">
  <aside class="sidebar">
  <div id = "title" class="container sidebar-sticky">
    <div class="sidebar-about">
      <a href="https://ichochy.com/"><p class="title">回忆中的明天</p></a>
      <p class="lead">码农小站，写点Java、Swift和感悟</p>
    </div>
      <p>
        <span id="doc_search"></span>
      </p>
    <nav>
      <ul class="sidebar-nav">
        <li><a href="https://ichochy.com/">Index</a> </li>
        <li><a href="https://ichochy.com/search.html"> Search </a></li>
        <li><a href="https://ichochy.com/categories.html"> Categories </a></li>
        <li><a href="https://ichochy.com/about.html"> About </a></li>
        <li><a href="https://ichochy.com/sites.html"> Sites </a></li>
        <li><a href="https://ichochy.com/links.html"> Links </a></li></ul>
    </nav>
    <p>&copy; 2020 - 2024 iChochy.</p>
    <div class = "other">
    
    
    </div>
  </div>
  
  <script type="text/javascript" src="https://ichochy.com/js/toc.js" defer></script>
  <div id = "toc" class="container sidebar-toc">
  <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#osppvbs-脚本">ospp.vbs 脚本</a></li>
        <li><a href="#osppvbs-的全局选项">ospp.vbs 的全局选项</a></li>
        <li><a href="#osppvbs-的-kms-客户端选项">ospp.vbs 的 KMS 客户端选项</a></li>
        <li><a href="#使用-osppvbs-的方案">使用 ospp.vbs 的方案</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
  
</aside>
    <main class="content container">
    <h2>
	<a href="https://ichochy.com/">Index</a>
	  
       / <a href="https://ichochy.com/categories/software.html">Software</a>
</h2>

<div class="post">
	<h1 class="post-title">
	Office 批量激活的命令工具 ospp



	</h1>
  
    <em>
        <time class="post-date">
            <b>Time：</b>2020/06/02 19:22:45
        </time>
    </em>
    
  
  <div class="related">
    <ul class="related-tags">
      <strong>Tags:</strong>
      
      <li>
        <a href="https://ichochy.com/tags/office.html">#office</a>
      </li>
      
      <li>
        <a href="https://ichochy.com/tags/kms.html">#kms</a>
      </li>
      
      <li>
        <a href="https://ichochy.com/tags/key.html">#key</a>
      </li>
      
      <li>
        <a href="https://ichochy.com/tags/slmgr.html">#slmgr</a>
      </li>
      
      <li>
        <a href="https://ichochy.com/tags/ospp.html">#ospp</a>
      </li>
      
      <li>
        <a href="https://ichochy.com/tags/software.html">#software</a>
      </li>
      
    </ul>
  </div>
  

    <b>原文：</b><a href="https://ichochy.com/posts/software/20200602.html">https://ichochy.com/posts/software/20200602.html</a>
    <hr>

  <p>Office 软件保护平台脚本使你能够配置 Office 产品（包括 Project 和 Visio）的批量许可版本。</p>
<h3 id="osppvbs-脚本">ospp.vbs 脚本</h3>
<p>opss.vbs 脚本位于 <code>Program Files\Microsoft Office\Office16</code> 或 <code>Program Files (x86)\Microsoft Office\Office16</code> 文件夹。</p>
<p><strong>适用于：</strong> Office 2019 和 Office 2016（包括 Project 和 Visio）的批量许可版本</p>
<p><strong>运行 ospp.vbs 需要 cscript.exe 脚本引擎</strong></p>
<p>若要查看帮助文件，请键入以下命令，然后按 Enter：</p>
<pre tabindex="0"><code>cscript ospp.vbs /?
</code></pre><p>常规语法如下所示：</p>
<pre tabindex="0"><code>cscript ospp.vbs [Option:Value] [ComputerName] [User] [Password]
</code></pre><p><code>Option</code>：指定用于执行以下操作的选项和值：激活产品、安装或卸载产品密钥、安装和显示许可证信息、设置 KMS 主机名和端口，以及删除 KMS 主机名和端口。本节中的表中列出了这些选项和值。<br>
<code>ComputerName</code>：远程计算机的名称。如果不提供计算机名称，则使用本地计算机。<br>
<code>User</code>：在远程计算机上拥有所需权限的帐户。<br>
<code>Password</code>：帐户的密码。如果不提供用户帐户和密码，则使用当前凭据。</p>
<h3 id="osppvbs-的全局选项">ospp.vbs 的全局选项</h3>
<table>
<thead>
<tr>
<th>全局选项</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>/act</td>
<td>激活已安装的 Office 产品密钥。</td>
</tr>
<tr>
<td>/inpkey:value</td>
<td>使用用户提供的产品密钥安装产品密钥（取代现有密钥）。Value 选项为必需。</td>
</tr>
<tr>
<td>/unpkey:value</td>
<td>卸载安装的产品密钥（包含要卸载的产品密钥的最后五位数，如 /dstatus 选项显示）。Value 参数必需。</td>
</tr>
<tr>
<td>/inslic:value</td>
<td>使用用户提供的 .xrm-ms 许可证路径安装许可证。Value 参数必需。</td>
</tr>
<tr>
<td>/dstatus</td>
<td>显示已安装产品密钥的许可证信息。</td>
</tr>
<tr>
<td>/dstatusall</td>
<td>显示所有已安装许可证的许可证信息。</td>
</tr>
<tr>
<td>/dhistoryacterr</td>
<td>显示 MAK/零售激活的失败历史记录。</td>
</tr>
<tr>
<td>/dinstid</td>
<td>显示用于脱机激活的安装 ID。</td>
</tr>
<tr>
<td>/actcid:value</td>
<td>使用用户提供的确认 ID 激活产品。Value 参数必需。</td>
</tr>
<tr>
<td>/rearm</td>
<td>重置所有已安装 Office 产品密钥的许可状态。</td>
</tr>
<tr>
<td>/rearm:value</td>
<td>重置具有用户提供的 SKUID 值的 Office 许可证的许可状态。 Value 参数必需。</td>
</tr>
<tr>
<td>/ddescr:value</td>
<td>显示用户提供的错误代码的说明。Value 参数必需。</td>
</tr>
</tbody>
</table>
<h3 id="osppvbs-的-kms-客户端选项">ospp.vbs 的 KMS 客户端选项</h3>
<table>
<thead>
<tr>
<th>KMS 客户端选项</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>/dhistorykms</td>
<td>显示 KMS 客户端激活历史记录。</td>
</tr>
<tr>
<td>/dcmid</td>
<td>显示 KMS 客户端计算机 ID (CMID)。</td>
</tr>
<tr>
<td>/sethst:value</td>
<td>使用用户提供的主机名设置 KMS 主机名。Value 参数为必需。这将设置 HKLM\Software\Microsoft\OfficeSoftwareProtectionPlatform\KeyManagementServiceName (REG_SZ) 。</td>
</tr>
<tr>
<td>/setprt:value</td>
<td>使用用户提供的端口号设置 KMS 端口。默认端口号为 1688。Value 参数为必需。这将设置 HKLM\Software\Microsoft\OfficeSoftwareProtectionPlatform\KeyManagementServicePort (REG_SZ) 。</td>
</tr>
<tr>
<td>/remhst</td>
<td>删除 KMS 主机名并将端口设置为默认值。默认端口为 1688。</td>
</tr>
<tr>
<td>/cachst:value</td>
<td>允许或拒绝 KMS 主机缓存。Value 参数必需（TRUE 或 FALSE）。</td>
</tr>
<tr>
<td>/actype:value</td>
<td>设置批量激活类型。Value 参数必需。值：1（表示基于 Active Directory），2（表示 KMS），0（表示二者）。</td>
</tr>
<tr>
<td>/skms-domain:value</td>
<td>设置可在其中找到所有 KMS SRV 记录的特定 DNS 域。如果特定的一个 KMS 主机名是由 /sethst 选项设置的，则此设置不起作用。Value 参数是完全限定的域名 (FQDN) 并且必需。</td>
</tr>
<tr>
<td>/ckms-domain</td>
<td>清除可在其中找到所有 KMS SRV 记录的特定 DNS 域。如果特定 KMS 主机是由 /sethst 选项设置的，则会使用该主机。否则，将使用 KMS 主机的自动发现。</td>
</tr>
</tbody>
</table>
<h3 id="使用-osppvbs-的方案">使用 ospp.vbs 的方案</h3>
<h4 id="在远程计算机上将产品密钥更改为-mak-密钥">在远程计算机上将产品密钥更改为 MAK 密钥</h4>
<ol>
<li>如果远程计算机名为 contoso1，请运行以下命令输入产品密钥。此操作假定您在远程计算机上拥有管理员凭据。如果您在远程计算机上的凭据与您的登录名和密码不同，则必须在命令行中键入您的登录名和密码，然后按 Enter：</li>
</ol>
<pre tabindex="0"><code>cscript ospp.vbs /inpkey:xxxxx-xxxxx-xxxxx-xxxxx-xxxxx contoso1
</code></pre><ol start="2">
<li>若要激活远程计算机，请键入以下命令，然后按 Enter：</li>
</ol>
<pre tabindex="0"><code>cscript ospp.vbs /act contoso1
</code></pre><h4 id="诊断-kms-激活错误">诊断 KMS 激活错误</h4>
<ol>
<li>如果计算机安装了 KMS 客户端密钥，请检查授权状态。为此，请键入以下命令，然后按 Enter：</li>
</ol>
<pre tabindex="0"><code>cscript ospp.vbs /dstatusall
</code></pre><ol start="2">
<li>若要检查 KMS 激活历史记录，请键入以下命令，然后按 Enter：</li>
</ol>
<pre tabindex="0"><code>cscript ospp.vbs /dhistorykms
</code></pre><ol start="3">
<li>若要触发激活，请键入以下命令，然后按 Enter：</li>
</ol>
<pre tabindex="0"><code>cscript ospp.vbs /act
</code></pre><ol start="4">
<li>检查错误消息中是否有错误代码 0xC004F042。如果在通知对话框中看到向用户显示的错误代码，您也可以使用该代码来检查错误消息。为此，请键入以下命令，然后按 Enter：</li>
</ol>
<pre tabindex="0"><code>cscript ospp.vbs /ddescr:0xC004F042
</code></pre><h4 id="打开或关闭-kms-客户端上的-kms-主机缓存">打开或关闭 KMS 客户端上的 KMS 主机缓存</h4>
<ol>
<li>在 KMS 客户端计算机上，若要打开缓存，请键入下面的命令，然后按 Enter：</li>
</ol>
<pre tabindex="0"><code>cscript ospp.vbs /cachst:TRUE
</code></pre><ol start="2">
<li>在 KMS 客户端计算机上，若要关闭缓存，请键入下面的命令，然后按 Enter：</li>
</ol>
<pre tabindex="0"><code>cscript ospp.vbs /cachst:FALSE
</code></pre><h4 id="测试-kms-主机名然后设置为自动发现">测试 KMS 主机名，然后设置为自动发现</h4>
<ol>
<li>如果在测试名为 kmstest.contoso.com 的 KMS 主机，并且要在 KMS 客户端中指定该主机，请键入以下命令，然后按 Enter：</li>
</ol>
<pre tabindex="0"><code>cscript ospp.vbs /sethst:kmstest.contoso.com
</code></pre><ol start="2">
<li>若要触发激活，请键入以下命令，然后按 Enter：</li>
</ol>
<pre tabindex="0"><code>cscript ospp.vbs /act
</code></pre><ol start="3">
<li>若要检查 KMS 激活历史记录以查看是否成功连接主机，请键入以下命令，然后按 Enter：</li>
</ol>
<pre tabindex="0"><code>cscript ospp.vbs /dhistorykms
</code></pre><ol start="4">
<li>现在，您希望此 KMS 客户端使用域名系统 (DNS) 自动发现生产 KMS 主机。若要移除 KMS 主机名，请键入以下命令，然后按 Enter：</li>
</ol>
<pre tabindex="0"><code>cscript ospp.vbs /remhst
</code></pre>
  


<div class="related">
    <h2>相关文章</h2>
    <ul class="related-posts">
        
        <li>
            <h3>
                <a href="https://ichochy.com/posts/software/20200528.html">
                    KMS 激活 Office 批量许可证密钥 KEY
                </a>
                <small>
                    2020/05/28
                </small>
            </h3>
        </li>
        
        <li>
            <h3>
                <a href="https://ichochy.com/posts/software/20200222.html">
                    mysql 使用 source/mysqldump 命令导入/导出文件信息
                </a>
                <small>
                    2020/02/22
                </small>
            </h3>
        </li>
        
        <li>
            <h3>
                <a href="https://ichochy.com/posts/software/20190410.html">
                    持续集成和持续交付工具-jenkins
                </a>
                <small>
                    2019/04/10
                </small>
            </h3>
        </li>
        
    </ul>
</div>


  


<h2 id="打赏">打赏</h2>
<img src="https://ichochy.com/sponsor.jpg" alt="Sponsor">
<hr>


  
<div class="pagination">
  <span class="pagination-item older">
    
    <a href="https://ichochy.com/posts/software/20200528.html" class="pag-link">上一篇</a>
    
  </span>
  <span class="pagination-item newer">
    
    <a href="https://ichochy.com/posts/software/20200605.html" class="pag-link">下一篇</a>
    
  </span>
</div>


</div>


    </main>
  </body>

<link rel="preconnect" href="https://NKR7XWIWN9-dsn.algolia.net" crossorigin />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@docsearch/css@3"/>
<script src="https://cdn.jsdelivr.net/npm/@docsearch/js@3"></script>
<script src = "/js/doc_search.js"></script>

<script data-ad-client="ca-pub-3691661241035911" async
        src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-8J2LHY81SL"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() {
        window.dataLayer.push(arguments);
    }
    gtag('js', new Date());
    gtag('config', 'G-8J2LHY81SL');
</script></html>
